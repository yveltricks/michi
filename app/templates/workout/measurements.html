{% extends "base.html" %}
{% block title %}Measurements{% endblock %}
{% block content %}
<!-- 
Main container for the measurements dashboard.
Uses a responsive grid layout that adjusts from 1 to 3 columns
based on screen size, with consistent spacing between cards.
-->
<div class="container mx-auto px-4 py-8">
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold mb-2">Body Measurements</h1>
        <p class="text-gray-600">Track your body measurements to monitor your progress</p>
    </div>

    <!-- 
    Responsive grid of measurement cards.
    Each card displays the most recent measurement value and links
    to a dedicated tracking page for that specific measurement.
    -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- 
        Weight card - shows the latest weight in the user's preferred unit.
        Includes a "Most Recent" label to indicate it's showing the latest entry.
        -->
        <a href="{{ url_for('workout.track_measurement', measurement_type='weight') }}" 
           class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 relative overflow-hidden">
            <div class="absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 rounded-bl-lg text-sm">
                Most Recent
            </div>
            <div class="p-6">
                <h2 class="text-xl font-semibold mb-2">Weight</h2>
                <p class="text-gray-600 mb-3">Track your body weight progress</p>
                {% set latest_weight = Measurement.get_latest_measurement(current_user.id, 'weight') %}
                {% if latest_weight %}
                <div class="mt-4 text-center">
                    {% if current_user.preferred_weight_unit == 'lbs' %}
                        <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_weight.value * 2.20462) }}</span>
                        <span class="text-gray-500">lbs</span>
                    {% else %}
                        <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_weight.value) }}</span>
                        <span class="text-gray-500">kg</span>
                    {% endif %}
                    <div class="text-xs text-gray-400 mt-1">
                        {{ latest_weight.date.strftime('%B %d, %Y') }}
                    </div>
                </div>
                {% else %}
                <div class="mt-4 text-center">
                    <span class="text-gray-500">No data available</span>
                </div>
                {% endif %}
            </div>
        </a>

        <!-- 
        Body fat percentage card - always displays in percentage format.
        Includes date of measurement for context.
        -->
        <a href="{{ url_for('workout.track_measurement', measurement_type='body_fat') }}"
           class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 relative overflow-hidden">
            <div class="absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 rounded-bl-lg text-sm">
                Most Recent
            </div>
            <div class="p-6">
                <h2 class="text-xl font-semibold mb-2">Body Fat</h2>
                <p class="text-gray-600 mb-3">Monitor your body fat percentage</p>
                {% set latest_bf = Measurement.get_latest_measurement(current_user.id, 'body_fat') %}
                {% if latest_bf %}
                <div class="mt-4 text-center">
                    <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_bf.value) }}</span>
                    <span class="text-gray-500">%</span>
                    <div class="text-xs text-gray-400 mt-1">
                        {{ latest_bf.date.strftime('%B %d, %Y') }}
                    </div>
                </div>
                {% else %}
                <div class="mt-4 text-center">
                    <span class="text-gray-500">No data available</span>
                </div>
                {% endif %}
            </div>
        </a>

        <!-- 
        Chest measurement card - displays in cm or inches based on user preference.
        Uses unit conversion for consistent display regardless of storage format.
        -->
        <a href="{{ url_for('workout.track_measurement', measurement_type='chest') }}"
           class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 relative overflow-hidden">
            <div class="absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 rounded-bl-lg text-sm">
                Most Recent
            </div>
            <div class="p-6">
                <h2 class="text-xl font-semibold mb-2">Chest</h2>
                <p class="text-gray-600 mb-3">Track your chest circumference</p>
                {% set latest_chest = Measurement.get_latest_measurement(current_user.id, 'chest') %}
                {% if latest_chest %}
                <div class="mt-4 text-center">
                    {% if current_user.preferred_measurement_unit == 'in' %}
                        <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_chest.value * 0.393701) }}</span>
                        <span class="text-gray-500">in</span>
                    {% else %}
                        <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_chest.value) }}</span>
                        <span class="text-gray-500">cm</span>
                    {% endif %}
                    <div class="text-xs text-gray-400 mt-1">
                        {{ latest_chest.date.strftime('%B %d, %Y') }}
                    </div>
                </div>
                {% else %}
                <div class="mt-4 text-center">
                    <span class="text-gray-500">No data available</span>
                </div>
                {% endif %}
            </div>
        </a>

        <!-- 
        Waist measurement card - important for tracking core changes.
        Displays in user's preferred unit with automatic conversion.
        -->
        <a href="{{ url_for('workout.track_measurement', measurement_type='waist') }}"
           class="block bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow duration-200 relative overflow-hidden">
            <div class="absolute top-0 right-0 bg-blue-500 text-white px-3 py-1 rounded-bl-lg text-sm">
                Most Recent
            </div>
            <div class="p-6">
                <h2 class="text-xl font-semibold mb-2">Waist</h2>
                <p class="text-gray-600 mb-3">Monitor your waist measurements</p>
                {% set latest_waist = Measurement.get_latest_measurement(current_user.id, 'waist') %}
                {% if latest_waist %}
                <div class="mt-4 text-center">
                    {% if current_user.preferred_measurement_unit == 'in' %}
                        <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_waist.value * 0.393701) }}</span>
                        <span class="text-gray-500">in</span>
                    {% else %}
                        <span class="text-2xl font-bold text-blue-600">{{ "%.1f"|format(latest_waist.value) }}</span>
                        <span class="text-gray-500">cm</span>
                    {% endif %}
                    <div class="text-xs text-gray-400 mt-1">
                        {{ latest_waist.date.strftime('%B %d, %Y') }}
                    </div>
                </div>
                {% else %}
                <div class="mt-4 text-center">
                    <span class="text-gray-500">No data available</span>
                </div>
                {% endif %}
            </div>
        </a>

        <!-- 
        Arms section - consolidated card with links to all arm measurements.
        Groups related measurements for more efficient use of space.
        -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4">Arms</h2>
            <div class="space-y-4">
                <!-- Left bicep measurement with hover effect for better interactivity -->
                <a href="{{ url_for('workout.track_measurement', measurement_type='left_bicep') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Left Bicep</span>
                    {% set latest_left_bicep = Measurement.get_latest_measurement(current_user.id, 'left_bicep') %}
                    {% if latest_left_bicep %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_left_bicep.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_left_bicep.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
                <!-- Right bicep measurement with consistent styling to match left side -->
                <a href="{{ url_for('workout.track_measurement', measurement_type='right_bicep') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Right Bicep</span>
                    {% set latest_right_bicep = Measurement.get_latest_measurement(current_user.id, 'right_bicep') %}
                    {% if latest_right_bicep %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_right_bicep.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_right_bicep.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
                <!-- Left forearm measurement for complete arm tracking -->
                <a href="{{ url_for('workout.track_measurement', measurement_type='left_forearm') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Left Forearm</span>
                    {% set latest_left_forearm = Measurement.get_latest_measurement(current_user.id, 'left_forearm') %}
                    {% if latest_left_forearm %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_left_forearm.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_left_forearm.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
                <!-- Right forearm measurement completes the arm measurements set -->
                <a href="{{ url_for('workout.track_measurement', measurement_type='right_forearm') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Right Forearm</span>
                    {% set latest_right_forearm = Measurement.get_latest_measurement(current_user.id, 'right_forearm') %}
                    {% if latest_right_forearm %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_right_forearm.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_right_forearm.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
            </div>
        </div>

        <!-- 
        Legs section - consolidated card with links to all leg measurements.
        Uses the same layout and hover effects as the arms section for consistency.
        -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4">Legs</h2>
            <div class="space-y-4">
                <!-- Left thigh measurement tracking -->
                <a href="{{ url_for('workout.track_measurement', measurement_type='left_thigh') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Left Thigh</span>
                    {% set latest_left_thigh = Measurement.get_latest_measurement(current_user.id, 'left_thigh') %}
                    {% if latest_left_thigh %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_left_thigh.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_left_thigh.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
                <a href="{{ url_for('workout.track_measurement', measurement_type='right_thigh') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Right Thigh</span>
                    {% set latest_right_thigh = Measurement.get_latest_measurement(current_user.id, 'right_thigh') %}
                    {% if latest_right_thigh %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_right_thigh.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_right_thigh.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
                <a href="{{ url_for('workout.track_measurement', measurement_type='left_calf') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Left Calf</span>
                    {% set latest_left_calf = Measurement.get_latest_measurement(current_user.id, 'left_calf') %}
                    {% if latest_left_calf %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_left_calf.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_left_calf.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
                <a href="{{ url_for('workout.track_measurement', measurement_type='right_calf') }}"
                   class="block hover:bg-gray-50 p-2 rounded">
                    <span class="font-medium">Right Calf</span>
                    {% set latest_right_calf = Measurement.get_latest_measurement(current_user.id, 'right_calf') %}
                    {% if latest_right_calf %}
                    <span class="float-right text-gray-500">
                        {% if current_user.preferred_measurement_unit == 'in' %}
                            {{ "%.1f"|format(latest_right_calf.value * 0.393701) }} in
                        {% else %}
                            {{ "%.1f"|format(latest_right_calf.value) }} cm
                        {% endif %}
                    </span>
                    {% endif %}
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}